/* Chat UI Styles */
.chat-launch { position:fixed; bottom:26px; right:28px; z-index:1200; width:60px; height:60px; border-radius:50%; background:var(--grad-accent); color:#fff; font-size:1.5rem; display:grid; place-items:center; border:1px solid rgba(255,255,255,.25); box-shadow:var(--accent-glow); cursor:pointer; transition:transform .35s, box-shadow .35s; }
.chat-launch:hover { transform:translateY(-4px) scale(1.05); }
.chat-launch:active { transform:scale(.95); }

.chat-panel { position:fixed; bottom:100px; right:28px; width:380px; height:520px; max-height:70vh; display:flex; flex-direction:column; background:var(--card-bg); backdrop-filter:blur(16px) saturate(1.1); border:1px solid var(--border-color); border-radius:24px; box-shadow:0 16px 42px -12px rgba(0,0,0,.55), 0 0 0 1px rgba(255,255,255,.05); overflow:hidden; animation:chatIn .4s ease; z-index:1250; }
.chat-panel.draggable { position:fixed; }
.chat-panel .resizer { position:absolute; width:18px; height:18px; right:8px; bottom:8px; cursor:nwse-resize; background:linear-gradient(135deg,var(--accent),var(--accent-alt)); border-radius:6px; opacity:.65; box-shadow:0 4px 10px -4px rgba(var(--accent-rgb),.6); }
.chat-panel .resizer:hover { opacity:1; }
@keyframes chatIn { from { opacity:0; transform:translateY(18px) scale(.96);} to { opacity:1; transform:translateY(0) scale(1);} }

.chat-header { display:flex; align-items:center; justify-content:space-between; padding:12px 14px 10px 18px; border-bottom:1px solid var(--border-color); background:linear-gradient(145deg,rgba(var(--accent-rgb),.15),rgba(var(--accent-rgb),.05)); }
.chat-title { font-weight:700; letter-spacing:.6px; font-size:.95rem; }
.chat-actions { display:flex; gap:6px; }
.chat-actions button { background:var(--card-bg); border:1px solid var(--border-color); border-radius:10px; width:34px; height:34px; display:grid; place-items:center; color:var(--muted-text); cursor:pointer; font-size:.8rem; transition:background .3s,border-color .3s,color .3s; }
.chat-actions button:hover { color:var(--text-color); border-color:var(--border-color-strong); }
.chat-actions button:disabled { opacity:.4; cursor:not-allowed; }

.chat-messages { flex:1; overflow-y:auto; padding:14px 16px 6px; display:flex; flex-direction:column; gap:10px; scrollbar-width:thin; position:relative; }
.chat-empty { opacity:.8; font-size:.8rem; line-height:1.5; }

.chat-msg { display:flex; align-items:flex-start; gap:8px; animation:msgIn .35s ease; }
@keyframes msgIn { from { opacity:0; transform:translateY(8px);} to { opacity:1; transform:translateY(0);} }
.chat-avatar { width:30px; height:30px; border-radius:12px; background:var(--grad-accent); display:grid; place-items:center; font-size:.9rem; color:#fff; box-shadow:0 4px 16px -4px rgba(var(--accent-rgb),.65); flex-shrink:0; }
.chat-msg.user .chat-avatar { background:linear-gradient(145deg,#64748b,#334155); box-shadow:0 4px 14px -4px rgba(0,0,0,.5); }

.chat-bubble { position:relative; max-width:70%; background:var(--card-bg); border:1px solid var(--border-color); padding:10px 14px; border-radius:18px; font-size:.8rem; line-height:1.5; white-space:pre-wrap; word-wrap:break-word; }
.chat-bubble code { background:rgba(0,0,0,.35); padding:2px 5px; border-radius:6px; font-size:.75rem; }
html[data-theme='light'] .chat-bubble code { background:rgba(0,0,0,.08); }
.chat-msg.assistant.sources-block .chat-bubble { background:linear-gradient(145deg,rgba(var(--accent-rgb),.12),rgba(var(--accent-rgb),.04)); }
.chat-msg.assistant .chat-bubble { background:linear-gradient(145deg,rgba(var(--accent-rgb),.22),rgba(var(--accent-rgb),.05)); }
.chat-msg.user .chat-bubble { background:linear-gradient(145deg,rgba(255,255,255,.12),rgba(255,255,255,.04)); }
html[data-theme='light'] .chat-msg.user .chat-bubble { background:linear-gradient(145deg,rgba(0,0,0,.05),rgba(0,0,0,.02)); }
html[data-theme='light'] .chat-msg.assistant .chat-bubble { background:linear-gradient(145deg,rgba(var(--accent-rgb),.18),rgba(var(--accent-rgb),.06)); }

.chat-msg.pending .chat-bubble { opacity:.85; }
.typing .dots { display:inline-flex; gap:2px; }
.typing .dots span { animation:blink 1s infinite ease-in-out; }
.typing .dots span:nth-child(2){ animation-delay:.2s; }
.typing .dots span:nth-child(3){ animation-delay:.4s; }
@keyframes blink { 0%,80%,100% { opacity:.2;} 40% { opacity:1;} }

.chat-input-bar { border-top:1px solid var(--border-color); padding:10px 12px 12px; display:flex; flex-direction:column; gap:8px; background:var(--card-bg); }
.chat-input { resize:none; max-height:140px; border:1px solid var(--border-color); background:var(--input-bg, var(--card-bg)); color:var(--text-color); padding:10px 12px; border-radius:14px; font-size:.82rem; line-height:1.35; font-family:inherit; outline:none; transition:border-color .3s, box-shadow .3s; }
.chat-input:focus { border-color:var(--input-border-focus,var(--accent)); box-shadow:0 0 0 2px rgba(var(--accent-rgb),.3); }
.send-btn { align-self:flex-end; background:var(--grad-accent); color:#fff; border:none; padding:8px 18px; font-size:.75rem; font-weight:700; border-radius:14px; cursor:pointer; letter-spacing:.5px; box-shadow:var(--accent-glow); transition:transform .3s; }
.send-btn:disabled { opacity:.5; cursor:not-allowed; box-shadow:none; }
.send-btn:hover:not(:disabled) { transform:translateY(-2px); }

.edit-indicator { font-size:.65rem; letter-spacing:.6px; background:var(--card-bg); padding:4px 8px; border:1px solid var(--border-color); border-radius:8px; display:inline-flex; align-items:center; gap:6px; }
.edit-indicator button { background:transparent; border:1px solid var(--border-color); border-radius:6px; font-size:.65rem; cursor:pointer; padding:2px 6px; }

/* Scrollbars */
.chat-messages::-webkit-scrollbar { width:8px; }
.chat-messages::-webkit-scrollbar-track { background:transparent; }
.chat-messages::-webkit-scrollbar-thumb { background:var(--scroll-thumb); border-radius:10px; }

@media (max-width:640px){
  .chat-panel { width:calc(100% - 32px); right:16px; bottom:90px; }
  .chat-launch { bottom:18px; right:18px; width:56px; height:56px; }
  .chat-bubble { max-width:78%; }
}
